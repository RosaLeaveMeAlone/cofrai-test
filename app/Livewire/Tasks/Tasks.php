<?php

namespace App\Livewire\Tasks;

use App\Http\Traits\WithTable;
use App\Models\Task;
use Livewire\Component;

class Tasks extends Component
{
    use WithTable;
    // -----------------------------------------------------------------------------------------------------------------
    // @ Rules
    // -----------------------------------------------------------------------------------------------------------------

    // -----------------------------------------------------------------------------------------------------------------
    // @ Listeners
    // -----------------------------------------------------------------------------------------------------------------
    protected $listeners = ['refreshPage' => 'refreshPage'];

    public function refreshPage()
    {
        $this->resetPage();
    }
    // -----------------------------------------------------------------------------------------------------------------
    // @ Lifecycle Hooks
    // -----------------------------------------------------------------------------------------------------------------

    // -----------------------------------------------------------------------------------------------------------------
    // @ Computed Properties
    // -----------------------------------------------------------------------------------------------------------------
    public function getTasksQueryProperty()
    {
        return Task::filter(
            $this->search,
            $this->sortByAttribute,
            $this->sortDirection,
            auth()->id(),
        );
    }

    public function getTasksProperty()
    {
        $tasksQuery = clone $this->tasks_query;

        return $tasksQuery->paginate(2);
    }
    // -----------------------------------------------------------------------------------------------------------------
    // @ Public Functions
    // -----------------------------------------------------------------------------------------------------------------

    // -----------------------------------------------------------------------------------------------------------------
    // @ Private Functions
    // -----------------------------------------------------------------------------------------------------------------

    // -----------------------------------------------------------------------------------------------------------------
    // @ Render
    // -----------------------------------------------------------------------------------------------------------------
    
    public function render()
    {
        return view('livewire.tasks.tasks');
    }
}